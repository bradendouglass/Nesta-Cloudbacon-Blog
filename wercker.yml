---
box: ruby
build:
    steps:
        - bundle-install
        
        - script:
          name: generate production site
          code: |-
            bundle exec jekyll build --trace --destination ./_production
            ls -l ./_production
        - script:
          name: jekyll doctor
          code: bundle exec jekyll doctor
        - script:
          name: html proof
          code: ./script/cibuild
deploy :
  steps :
    - script:
        name: Configure git
        code: |-
          git config --global user.email "pleasemailus@wercker.com"
          git config --global user.name "wercker"

          rm -rf .git
    - script:
        name: Deploy to github pages
        code: |-
          git init
          git add .
          git commit -m "deploy commit from $WERCKER_STARTED_BY"
          git push -f $GIT_REMOTE master:gh-pages
